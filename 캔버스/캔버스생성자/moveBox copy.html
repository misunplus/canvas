<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>캔바스</title>
  <style>
    canvas {
      background: #eee;
    }
  </style>
</head>

<body>

  <canvas class="canvas 1" width="250" height="250" data-arc="365"></canvas>
  <canvas class="canvas 1" width="250" height="250" data-arc="288"></canvas>
  <canvas class="canvas 1" width="250" height="250" data-arc="216"></canvas>
  <div class="visual"></div>
  <script>
    const canvas = document.querySelectorAll("canvas");
    const canvasArray = [];
    const arcArray = [];
    let 각도값 = 0;
    // let 퍼센트값;

    function 라디안(각도) {
      return (각도 * Math.PI) / 180;
    }

    class SkillBox {
      constructor(canvas, x, y, 퍼센트값) {
        this.ctx = canvas.getContext("2d");
        this.x = x;
        this.y = y;
        this.퍼센트값 = 퍼센트값;
      }
    }

    const draw = function (퍼센트값, canvasArray) {
      // console.log(canvasArray.퍼센트값);
      // this.ctx.clearRect(0, 0, canvas.width, canvas.height)
      canvasArray.ctx.beginPath();
      canvasArray.ctx.arc(100, 75, 50, 0, 라디안(각도값), false);
      canvasArray.ctx.stroke();
      if (각도값 < 퍼센트값) {
        각도값 += 5;
      }
    }
    for (let i = 0; i < canvas.length; i++) {
      canvasArray[i] = canvas[i];
      arcArray[i] = canvas[i].dataset.arc;
      canvasArray[i] = new SkillBox(canvas[i], 200, 200, arcArray[i]);
    }

    let start = new Date().getTime();

    function render() {
      let timeSet = new Date().getTime();
      if (timeSet - 1000 > start) {
        console.log("sdaf");
        cancelAnimationFrame(render);
      } else {
        for (let i = 0; i < canvasArray.length; i++) {
          function 클로저(j) {
            setTimeout(function () {
              draw(arcArray[j], canvasArray[j]);
              console.log(arcArray[j], canvasArray[j])
              requestAnimationFrame(render);
            }, j * 2000);
          }
          클로저(i);
        }
      }
    }
    requestAnimationFrame(render);
  </script>
</body>

</html>